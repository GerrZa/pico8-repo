pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--main
function _init()
	pac={}
	pac.x=0
	pac.y=0
	pac.s=1
	pac.sx=0
	pac.sy=0
	pac.r=0
	m={}
	state="g"
	--map
	local m1={}
	m1.ix=0
	m1.iy=0
	m1.sx=4
	m1.sy=7
	add(m,m1)
	--init
	cm=m[1+flr(rnd(#m))]
	pac.x=cm.sx*8
	pac.y=cm.sy*8
end

function _update()
	if state=="g" then
		gameupd()
	end
end

function _draw()
	if state=="g" then
		gamedrw()
	end
end
-->8
--more update
function gameupd()
	local rp = btn(➡️)
	local lp = btn(⬅️)
	local up = btn(⬆️)
	local dp = btn(⬇️)
	
	local br = tcol(pac,"r") and pac.r==0
	local bl = tcol(pac,"l") and pac.r==0.5
	local bu = tcol(pac,"u") and pac.r==0.25
	local bd = tcol(pac,"d") and pac.r==0.75
	
	pac.s = 1+pac.r*4
	
	if rp then
		if (not tcol(pac,"r")) pac.r=0
	elseif lp then
		if (not tcol(pac,"l")) pac.r=0.5
	elseif up then
		if (not tcol(pac,"u")) pac.r=0.25
	elseif dp then
		if (not tcol(pac,"d")) pac.r=0.75
	end
	
	if not(br or bl or bu or bd) then
		pac.x+=cos(pac.r)
		pac.y+=sin(pac.r)
	end
	
end
-->8
--more draw
function gamedrw()
	cls()
	map(cm.ix,cm.iy)
	
	--pac
	if time()*5%1>0.5 then
		spr(5,pac.x,pac.y)
	else
		spr(pac.s,pac.x,pac.y)
	end
	
	local ax=pac.x
	local ay=pac.y
	
	local px=pac.x
	local py=pac.y
	--pset(px+8,py+7,8)
	--pset(px+8,py,8)
	--pset(px-1,py+7,11)
	--pset(px-1,py,11)
	--pset(px,py-1,14)
	--pset(px+7,py-1,14)
	--pset(px+7,py+8,8)
	--pset(px,py+8,8)
	
	line(px+8,py+7,px+8,py,8)
	line(px-1,py+7,px-1,py,11)
	line(px,py-1,px+7,py-1,14)
	line(px+7,py+8,px,py+8,9)
end
-->8
--tool
function tcol(a,t)
	local px=a.x
	local py=a.y
	if (fget(mget((px+8)/8,(py+7)/8),0) or fget(mget((px+8)/8,py/8),0)) and t=="r" then
		return true
	end
	if (fget(mget((px-1)/8,(py+7)/8),0) or fget(mget((px-1)/8,py/8),0)) and t=="l" then
		return true 
	end
	if (fget(mget(px/8,(py-1)/8),0) or fget(mget((px+7)/8,(py-1)/8),0)) and t=="u" then
		return true
	end
	if (fget(mget((px+7)/8,(py+8)/8),0) or fget(mget(px/8,(py+8)/8),0)) and t=="d" then
		return true
	end
	return false
	
end	


function tcol2(a,t)
	local ax=a.x
	local ay=a.y
	
	if (fget(mget((ax+8)/8,ay/8),0) and t=="r") return true
	if (fget(mget((ax-1)/8,ay/8),0) and t=="l") return true
	if (fget(mget(ax/8,(ay-1)/8),0) and t=="u") return true
	if (fget(mget(ax/8,(ay+8)/8),0) and t=="d") return true
	
	
	return false
end
__gfx__
0000000000aaaa000000000000aaaa0000aaaa0000aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000aaaaaa00a0000a00aaaaaa00aaaaaa00aaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700aaaaaa00aaa00aaa00aaaaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aaaa0000aaa00aaa0000aaaaaaaaaaaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000aaaa0000aaaaaaaa0000aaaaaaa00aaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700aaaaaa00aaaaaaaa00aaaaaaaaa00aaaaaaaaaaa00000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000aaaaaa00aaaaaa00aaaaaa00a0000a00aaaaaa000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000aaaa0000aaaa0000aaaa000000000000aaaa0000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0dccccccccccccccccccccd0000000000dccccccccccccccccccccd0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c0000dccccccccccd0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c0000c0000000000c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c0000000000c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c0000000dccccd0000000c00dccccd00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c0000000c0000c0000000c00c0000c00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c0000000c0000c0000000c00c0000c00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c0000000c0000c0000000c00c0000c00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c0000000c0000c0000000c00c0000c00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c0000000dccccd0000000c00c0000c00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c0000c0cccccccc0c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c0000c0000000000c0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c0000dccccccccccd0000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0c00000000000000000000c00c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0dccccccccccccccccccccd00c0000c00dccccccccccccccccccccd0000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000c0000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000c0000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000022000000880000c0000c00dccccccccccccccccccccd0000000000000000000000000000000000000000000000000000000000000000000000000
0000000000200200008008000c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0000000002022020080880800c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0000000002022020080880800c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0000000000200200008008000c0000c00c00000000000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000
0000000000022000000880000dccccd00dccccccccccccccccccccd0000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001010100010101000000000000000000010101010101010000000000000000000101010101010100000000000000000001000001010101000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
4445454545454545454545454545454600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400000000000000000000000000005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400404200404142004042007476005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200507052005052000000005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200507052005052004042005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200507052006062005052005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400606200507052000000005052005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400000043507052004042005052005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400404200507052005052005052005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200507052005052005052005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200507052005052005052005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200606162006062006062005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400505200000000000000000000005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400606200747575757576007476005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5400000000000000000000000000005600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
6465656565656565656565656565656600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
